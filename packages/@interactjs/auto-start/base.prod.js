Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=((t,e)=>{if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=i(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var l=a?Object.getOwnPropertyDescriptor(t,o):null;l&&(l.get||l.set)?Object.defineProperty(r,o,l):r[o]=t[o]}return r.default=t,n&&n.set(t,r),r})(require("../utils/domUtils.prod.js")),e=o(require("../utils/extend.prod.js")),n=o(require("../utils/is.prod.js")),r=require("../utils/misc.prod.js"),a=o(require("./InteractableMethods"));function o(t){return t&&t.__esModule?t:{default:t}}function i(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(i=t=>t?n:e)(t)}function l(t,e,n,r,a){return e.testIgnoreAllow(e.options[t.name],n,r)&&e.options[t.name].enabled&&p(e,n,t,a)?t:null}function u(t,e,n,r,a,o,i){for(let u=0,c=r.length;u<c;u++){const c=r[u],s=a[u],p=c.getAction(e,n,t,s);if(!p)continue;const m=l(p,c,s,o,i);if(m)return{action:m,interactable:c,element:s}}return{action:null,interactable:null,element:null}}function c(e,r,a,o,i){let l=[],c=[],s=o;function p(t){l.push(t),c.push(s)}for(;n.default.element(s);){l=[],c=[],i.interactables.forEachMatch(s,p);const n=u(e,r,a,l,c,o,i);if(n.action&&!n.interactable.options[n.action.name].manualStart)return n;s=t.parentNode(s)}return{action:null,interactable:null,element:null}}function s(t,{action:e,interactable:n,element:a},o){e=e||{name:null},t.interactable=n,t.element=a,(0,r.copyAction)(t.prepared,e),t.rect=n&&e.name?n.getRect(a):null,d(t,o),o.fire("autoStart:prepared",{interaction:t})}function p(t,e,n,r){const a=t.options,o=a[n.name].max,i=a[n.name].maxPerElement,l=r.autoStart.maxInteractions;let u=0,c=0,s=0;if(!(o&&i&&l))return!1;for(const a of r.interactions.list){const r=a.prepared.name;if(a.interacting()){if(u++,u>=l)return!1;if(a.interactable===t){if(c+=r===n.name?1:0,c>=o)return!1;if(a.element===e&&(s++,r===n.name&&s>=i))return!1}}}return l>0}function m(t,e){return n.default.number(t)?(e.autoStart.maxInteractions=t,this):e.autoStart.maxInteractions}function f(t,e,n){const{cursorElement:r}=n.autoStart;r&&r!==t&&(r.style.cursor=""),t.ownerDocument.documentElement.style.cursor=e,t.style.cursor=e,n.autoStart.cursorElement=e?t:null}function d(t,e){const{interactable:r,element:a,prepared:o}=t;if("mouse"!==t.pointerType||!r||!r.options.styleCursor)return void(e.autoStart.cursorElement&&f(e.autoStart.cursorElement,"",e));let i="";if(o.name){const l=r.options[o.name].cursorChecker;i=n.default.func(l)?l(o,r,a,t._interacting):e.actions.map[o.name].getCursor(o)}f(t.element,i||"",e)}const b={id:"auto-start/base",before:["actions"],install(t){const{interactStatic:n,defaults:r}=t;t.usePlugin(a.default),r.base.actionChecker=null,r.base.styleCursor=!0,(0,e.default)(r.perAction,{manualStart:!1,max:1/0,maxPerElement:1,allowFrom:null,ignoreFrom:null,mouseButtons:1}),n.maxInteractions=e=>m(e,t),t.autoStart={maxInteractions:1/0,withinInteractionLimit:p,cursorElement:null}},listeners:{"interactions:down"({interaction:t,pointer:e,event:n,eventTarget:r},a){t.interacting()||s(t,c(t,e,n,r,a),a)},"interactions:move"(t,e){(({interaction:t,pointer:e,event:n,eventTarget:r},a)=>{"mouse"!==t.pointerType||t.pointerIsDown||t.interacting()||s(t,c(t,e,n,r,a),a)})(t,e),((t,e)=>{const{interaction:n}=t;if(!n.pointerIsDown||n.interacting()||!n.pointerWasMoved||!n.prepared.name)return;e.fire("autoStart:before-start",t);const{interactable:r}=n,a=n.prepared.name;a&&r&&(r.options[a].manualStart||!p(r,n.element,n.prepared,e)?n.stop():(n.start(n.prepared,r,n.element),d(n,e)))})(t,e)},"interactions:stop"({interaction:t},e){const{interactable:n}=t;n&&n.options.styleCursor&&f(t.element,"",e)}},maxInteractions:m,withinInteractionLimit:p,validateAction:l};exports.default=b;
//# sourceMappingURL=base.prod.js.map