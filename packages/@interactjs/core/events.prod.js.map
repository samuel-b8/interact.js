{
	"version": 3,
	"names": [
		"arr",
		"_interopRequireWildcard",
		"require",
		"domUtils",
		"_isProd",
		"_interopRequireDefault",
		"_pointerExtendProd",
		"pointerUtils",
		"obj",
		"__esModule",
		"default",
		"_getRequireWildcardCache",
		"e",
		"WeakMap",
		"r",
		"t",
		"has",
		"get",
		"n",
		"__proto__",
		"a",
		"Object",
		"defineProperty",
		"getOwnPropertyDescriptor",
		"u",
		"prototype",
		"hasOwnProperty",
		"call",
		"i",
		"set",
		"FakeEvent",
		"currentTarget",
		"originalEvent",
		"type",
		"constructor",
		"this",
		"pExtend",
		"preventOriginalDefault",
		"preventDefault",
		"stopPropagation",
		"stopImmediatePropagation",
		"getOptions",
		"param",
		"is",
		"object",
		"capture",
		"passive",
		"optionsMatch",
		"b",
		"exports",
		"id",
		"install",
		"scope",
		"_scope$document",
		"targets",
		"delegatedEvents",
		"documents",
		"eventsMethods",
		"add",
		"remove",
		"addDelegate",
		"selector",
		"context",
		"listener",
		"optionalArg",
		"options",
		"doc",
		"delegateListener",
		"delegateUseCapture",
		"delegates",
		"delegate",
		"find",
		"d",
		"listeners",
		"push",
		"func",
		"removeDelegate",
		"index",
		"matchFound",
		"length",
		"cur",
		"entry",
		"splice",
		"supportsOptions",
		"supportsPassive",
		"eventTarget",
		"addEventListener",
		"target",
		"events",
		"l",
		"removeEventListener",
		"targetIndex",
		"findIndex",
		"typeIsEmpty",
		"typeListeners",
		"keys",
		"event",
		"fakeEvent",
		"getEventTargets",
		"element",
		"matchesSelector",
		"nodeContains",
		"parentNode",
		"document",
		"createElement"
	],
	"sources": [
		"events.ts"
	],
	"sourcesContent": [
		"import * as arr from '@interactjs/utils/arr'\nimport * as domUtils from '@interactjs/utils/domUtils'\nimport is from '@interactjs/utils/is'\nimport pExtend from '@interactjs/utils/pointerExtend'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\n\nimport type { Scope } from '@interactjs/core/scope'\nimport type { Element } from '@interactjs/core/types'\n\nimport type { NativeEventTarget } from './NativeTypes'\n\ndeclare module '@interactjs/core/scope' {\n  interface Scope {\n    events: ReturnType<typeof install>\n  }\n}\n\ninterface EventOptions {\n  capture: boolean\n  passive: boolean\n}\n\ntype PartialEventTarget = Partial<NativeEventTarget>\n\ntype ListenerEntry = { func: (event: Event | FakeEvent) => any; options: EventOptions }\n\nfunction install(scope: Scope) {\n  const targets: Array<{\n    eventTarget: PartialEventTarget\n    events: { [type: string]: ListenerEntry[] }\n  }> = []\n\n  const delegatedEvents: {\n    [type: string]: Array<{\n      selector: string\n      context: Node\n      listeners: ListenerEntry[]\n    }>\n  } = {}\n  const documents: Document[] = []\n\n  const eventsMethods = {\n    add,\n    remove,\n\n    addDelegate,\n    removeDelegate,\n\n    delegateListener,\n    delegateUseCapture,\n    delegatedEvents,\n    documents,\n\n    targets,\n\n    supportsOptions: false,\n    supportsPassive: false,\n  }\n\n  // check if browser supports passive events and options arg\n  scope.document?.createElement('div').addEventListener('test', null, {\n    get capture() {\n      return (eventsMethods.supportsOptions = true)\n    },\n    get passive() {\n      return (eventsMethods.supportsPassive = true)\n    },\n  })\n\n  scope.events = eventsMethods\n\n  function add(\n    eventTarget: PartialEventTarget,\n    type: string,\n    listener: ListenerEntry['func'],\n    optionalArg?: boolean | EventOptions,\n  ) {\n    if (!eventTarget.addEventListener) return\n\n    const options = getOptions(optionalArg)\n    let target = arr.find(targets, (t) => t.eventTarget === eventTarget)\n\n    if (!target) {\n      target = {\n        eventTarget,\n        events: {},\n      }\n\n      targets.push(target)\n    }\n\n    if (!target.events[type]) {\n      target.events[type] = []\n    }\n\n    if (!arr.find(target.events[type], (l) => l.func === listener && optionsMatch(l.options, options))) {\n      eventTarget.addEventListener(\n        type,\n        listener as any,\n        eventsMethods.supportsOptions ? options : options.capture,\n      )\n      target.events[type].push({ func: listener, options })\n    }\n  }\n\n  function remove(\n    eventTarget: PartialEventTarget,\n    type: string,\n    listener?: 'all' | ListenerEntry['func'],\n    optionalArg?: boolean | EventOptions,\n  ) {\n    if (!eventTarget.addEventListener || !eventTarget.removeEventListener) return\n\n    const targetIndex = arr.findIndex(targets, (t) => t.eventTarget === eventTarget)\n    const target = targets[targetIndex]\n\n    if (!target || !target.events) {\n      return\n    }\n\n    if (type === 'all') {\n      for (type in target.events) {\n        if (target.events.hasOwnProperty(type)) {\n          remove(eventTarget, type, 'all')\n        }\n      }\n      return\n    }\n\n    let typeIsEmpty = false\n    const typeListeners = target.events[type]\n\n    if (typeListeners) {\n      if (listener === 'all') {\n        for (let i = typeListeners.length - 1; i >= 0; i--) {\n          const entry = typeListeners[i]\n          remove(eventTarget, type, entry.func, entry.options)\n        }\n        return\n      } else {\n        const options = getOptions(optionalArg)\n\n        for (let i = 0; i < typeListeners.length; i++) {\n          const entry = typeListeners[i]\n          if (entry.func === listener && optionsMatch(entry.options, options)) {\n            eventTarget.removeEventListener(\n              type,\n              listener as any,\n              eventsMethods.supportsOptions ? options : options.capture,\n            )\n            typeListeners.splice(i, 1)\n\n            if (typeListeners.length === 0) {\n              delete target.events[type]\n              typeIsEmpty = true\n            }\n\n            break\n          }\n        }\n      }\n    }\n\n    if (typeIsEmpty && !Object.keys(target.events).length) {\n      targets.splice(targetIndex, 1)\n    }\n  }\n\n  function addDelegate(\n    selector: string,\n    context: Node,\n    type: string,\n    listener: ListenerEntry['func'],\n    optionalArg?: any,\n  ) {\n    const options = getOptions(optionalArg)\n    if (!delegatedEvents[type]) {\n      delegatedEvents[type] = []\n\n      // add delegate listener functions\n      for (const doc of documents) {\n        add(doc, type, delegateListener)\n        add(doc, type, delegateUseCapture, true)\n      }\n    }\n\n    const delegates = delegatedEvents[type]\n    let delegate = arr.find(delegates, (d) => d.selector === selector && d.context === context)\n\n    if (!delegate) {\n      delegate = { selector, context, listeners: [] }\n      delegates.push(delegate)\n    }\n\n    delegate.listeners.push({ func: listener, options })\n  }\n\n  function removeDelegate(\n    selector: string,\n    context: Document | Element,\n    type: string,\n    listener?: ListenerEntry['func'],\n    optionalArg?: any,\n  ) {\n    const options = getOptions(optionalArg)\n    const delegates = delegatedEvents[type]\n    let matchFound = false\n    let index: number\n\n    if (!delegates) return\n\n    // count from last index of delegated to 0\n    for (index = delegates.length - 1; index >= 0; index--) {\n      const cur = delegates[index]\n      // look for matching selector and context Node\n      if (cur.selector === selector && cur.context === context) {\n        const { listeners } = cur\n\n        // each item of the listeners array is an array: [function, capture, passive]\n        for (let i = listeners.length - 1; i >= 0; i--) {\n          const entry = listeners[i]\n\n          // check if the listener functions and capture and passive flags match\n          if (entry.func === listener && optionsMatch(entry.options, options)) {\n            // remove the listener from the array of listeners\n            listeners.splice(i, 1)\n\n            // if all listeners for this target have been removed\n            // remove the target from the delegates array\n            if (!listeners.length) {\n              delegates.splice(index, 1)\n\n              // remove delegate function from context\n              remove(context, type, delegateListener)\n              remove(context, type, delegateUseCapture, true)\n            }\n\n            // only remove one listener\n            matchFound = true\n            break\n          }\n        }\n\n        if (matchFound) {\n          break\n        }\n      }\n    }\n  }\n\n  // bound to the interactable context when a DOM event\n  // listener is added to a selector interactable\n  function delegateListener(event: Event | FakeEvent, optionalArg?: any) {\n    const options = getOptions(optionalArg)\n    const fakeEvent = new FakeEvent(event as Event)\n    const delegates = delegatedEvents[event.type]\n    const [eventTarget] = pointerUtils.getEventTargets(event as Event)\n    let element: Node = eventTarget\n\n    // climb up document tree looking for selector matches\n    while (is.element(element)) {\n      for (let i = 0; i < delegates.length; i++) {\n        const cur = delegates[i]\n        const { selector, context } = cur\n\n        if (\n          domUtils.matchesSelector(element, selector) &&\n          domUtils.nodeContains(context, eventTarget) &&\n          domUtils.nodeContains(context, element)\n        ) {\n          const { listeners } = cur\n\n          fakeEvent.currentTarget = element\n\n          for (const entry of listeners) {\n            if (optionsMatch(entry.options, options)) {\n              entry.func(fakeEvent)\n            }\n          }\n        }\n      }\n\n      element = domUtils.parentNode(element)\n    }\n  }\n\n  function delegateUseCapture(this: Element, event: Event | FakeEvent) {\n    return delegateListener.call(this, event, true)\n  }\n\n  // for type inferrence\n  return eventsMethods\n}\n\nclass FakeEvent implements Partial<Event> {\n  currentTarget: Node\n  originalEvent: Event\n  type: string\n\n  constructor(originalEvent: Event) {\n    this.originalEvent = originalEvent\n    // duplicate the event so that currentTarget can be changed\n    pExtend(this, originalEvent)\n  }\n\n  preventOriginalDefault() {\n    this.originalEvent.preventDefault()\n  }\n\n  stopPropagation() {\n    this.originalEvent.stopPropagation()\n  }\n\n  stopImmediatePropagation() {\n    this.originalEvent.stopImmediatePropagation()\n  }\n}\n\nfunction getOptions(param: { [index: string]: any } | boolean): { capture: boolean; passive: boolean } {\n  if (!is.object(param)) {\n    return { capture: !!param, passive: false }\n  }\n\n  return {\n    capture: !!param.capture,\n    passive: !!param.passive,\n  }\n}\n\nfunction optionsMatch(a: Partial<EventOptions> | boolean, b: Partial<EventOptions>) {\n  if (a === b) return true\n\n  if (typeof a === 'boolean') return !!b.capture === a && !!b.passive === false\n\n  return !!a.capture === !!b.capture && !!a.passive === !!b.passive\n}\n\nexport default {\n  id: 'events',\n  install,\n}\n"
	],
	"mappings": "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"
}