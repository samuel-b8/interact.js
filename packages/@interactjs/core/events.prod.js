Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=a(require("../utils/arr.prod.js")),t=a(require("../utils/domUtils.prod.js")),n=o(require("../utils/is.prod.js")),r=o(require("../utils/pointerExtend.prod.js")),s=a(require("../utils/pointerUtils.prod.js"));function o(e){return e&&e.__esModule?e:{default:e}}function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=e=>e?n:t)(e)}function a(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=s?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}class u{currentTarget;originalEvent;type;constructor(e){this.originalEvent=e,(0,r.default)(this,e)}preventOriginalDefault(){this.originalEvent.preventDefault()}stopPropagation(){this.originalEvent.stopPropagation()}stopImmediatePropagation(){this.originalEvent.stopImmediatePropagation()}}function l(e){return n.default.object(e)?{capture:!!e.capture,passive:!!e.passive}:{capture:!!e,passive:!1}}function p(e,t){return e===t||("boolean"==typeof e?!!t.capture===e&&0==!!t.passive:!!e.capture==!!t.capture&&!!e.passive==!!t.passive)}exports.default={id:"events",install(r){var o;const i=[],a={},c=[],f={add:d,remove:v,addDelegate(t,n,r,s,o){const i=l(o);if(!a[r]){a[r]=[];for(const e of c)d(e,r,g),d(e,r,h,!0)}const u=a[r];let p=e.find(u,(e=>e.selector===t&&e.context===n));p||(p={selector:t,context:n,listeners:[]},u.push(p)),p.listeners.push({func:s,options:i})},removeDelegate(e,t,n,r,s){const o=l(s),i=a[n];let u,c=!1;if(i)for(u=i.length-1;u>=0;u--){const s=i[u];if(s.selector===e&&s.context===t){const{listeners:e}=s;for(let s=e.length-1;s>=0;s--){const a=e[s];if(a.func===r&&p(a.options,o)){e.splice(s,1),e.length||(i.splice(u,1),v(t,n,g),v(t,n,h,!0)),c=!0;break}}if(c)break}}},delegateListener:g,delegateUseCapture:h,delegatedEvents:a,documents:c,targets:i,supportsOptions:!1,supportsPassive:!1};function d(t,n,r,s){if(!t.addEventListener)return;const o=l(s);let a=e.find(i,(e=>e.eventTarget===t));a||(a={eventTarget:t,events:{}},i.push(a)),a.events[n]||(a.events[n]=[]),e.find(a.events[n],(e=>e.func===r&&p(e.options,o)))||(t.addEventListener(n,r,f.supportsOptions?o:o.capture),a.events[n].push({func:r,options:o}))}function v(t,n,r,s){if(!t.addEventListener||!t.removeEventListener)return;const o=e.findIndex(i,(e=>e.eventTarget===t)),a=i[o];if(!a||!a.events)return;if("all"===n){for(n in a.events)a.events.hasOwnProperty(n)&&v(t,n,"all");return}let u=!1;const c=a.events[n];if(c){if("all"===r){for(let e=c.length-1;e>=0;e--){const r=c[e];v(t,n,r.func,r.options)}return}{const e=l(s);for(let s=0;s<c.length;s++){const o=c[s];if(o.func===r&&p(o.options,e)){t.removeEventListener(n,r,f.supportsOptions?e:e.capture),c.splice(s,1),0===c.length&&(delete a.events[n],u=!0);break}}}}u&&!Object.keys(a.events).length&&i.splice(o,1)}function g(e,r){const o=l(r),i=new u(e),c=a[e.type],[f]=s.getEventTargets(e);let d=f;for(;n.default.element(d);){for(let e=0;e<c.length;e++){const n=c[e],{selector:r,context:s}=n;if(t.matchesSelector(d,r)&&t.nodeContains(s,f)&&t.nodeContains(s,d)){const{listeners:e}=n;i.currentTarget=d;for(const t of e)p(t.options,o)&&t.func(i)}}d=t.parentNode(d)}}function h(e){return g(e,!0)}return null==(o=r.document)||o.createElement("div").addEventListener("test",null,{get capture(){return f.supportsOptions=!0},get passive(){return f.supportsPassive=!0}}),r.events=f,f}};
//# sourceMappingURL=events.prod.js.map