{
	"version": 3,
	"names": [
		"arr",
		"_interopRequireWildcard",
		"require",
		"_misc",
		"pointerUtils",
		"_rect",
		"_getRequireWildcardCache",
		"e",
		"WeakMap",
		"r",
		"t",
		"__esModule",
		"default",
		"has",
		"get",
		"n",
		"__proto__",
		"a",
		"Object",
		"defineProperty",
		"getOwnPropertyDescriptor",
		"u",
		"prototype",
		"hasOwnProperty",
		"call",
		"i",
		"set",
		"install",
		"scope",
		"Interactable",
		"actions",
		"phases",
		"reflow",
		"action",
		"doReflow",
		"interactable",
		"elements",
		"getAllElements",
		"Promise",
		"window",
		"promises",
		"element",
		"rect",
		"getRect",
		"runningInteraction",
		"find",
		"interactions",
		"list",
		"interaction",
		"interacting",
		"prepared",
		"name",
		"reflowPromise",
		"move",
		"_reflowPromise",
		"resolve",
		"_reflowResolve",
		"xywh",
		"tlbrToXywh",
		"coords",
		"page",
		"x",
		"y",
		"client",
		"timeStamp",
		"now",
		"event",
		"coordsToEvent",
		"startReflow",
		"push",
		"all",
		"then",
		"new",
		"pointerType",
		"signalArg",
		"pointer",
		"eventTarget",
		"phase",
		"prevEvent",
		"updatePointer",
		"setZeroCoords",
		"delta",
		"copyAction",
		"_doPhase",
		"undefined",
		"start",
		"_interacting",
		"end",
		"stop",
		"removePointer",
		"id",
		"listeners",
		"interactions:stop",
		"remove",
		"_default",
		"exports"
	],
	"sources": [
		"plugin.ts"
	],
	"sourcesContent": [
		"import type { Interactable } from '@interactjs/core/Interactable'\nimport type { DoAnyPhaseArg, Interaction } from '@interactjs/core/Interaction'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type { ActionName, ActionProps, Element } from '@interactjs/core/types'\nimport * as arr from '@interactjs/utils/arr'\nimport { copyAction } from '@interactjs/utils/misc'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\nimport { tlbrToXywh } from '@interactjs/utils/rect'\n\ndeclare module '@interactjs/core/scope' {\n  interface SignalArgs {\n    'interactions:before-action-reflow': Omit<DoAnyPhaseArg, 'iEvent'>\n    'interactions:action-reflow': DoAnyPhaseArg\n    'interactions:after-action-reflow': DoAnyPhaseArg\n  }\n}\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    /**\n     * ```js\n     * const interactable = interact(target)\n     * const drag = { name: drag, axis: 'x' }\n     * const resize = { name: resize, edges: { left: true, bottom: true }\n     *\n     * interactable.reflow(drag)\n     * interactable.reflow(resize)\n     * ```\n     *\n     * Start an action sequence to re-apply modifiers, check drops, etc.\n     *\n     * @param { Object } action The action to begin\n     * @param { string } action.name The name of the action\n     * @returns { Promise } A promise that resolves to the `Interactable` when actions on all targets have ended\n     */\n    reflow<T extends ActionName>(action: ActionProps<T>): ReturnType<typeof doReflow>\n  }\n}\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    _reflowPromise: Promise<void>\n    _reflowResolve: (...args: unknown[]) => void\n  }\n}\n\ndeclare module '@interactjs/core/InteractEvent' {\n  interface PhaseMap {\n    reflow?: true\n  }\n}\n\nfunction install(scope: Scope) {\n  const { Interactable } = scope\n\n  scope.actions.phases.reflow = true\n\n  Interactable.prototype.reflow = function (action: ActionProps) {\n    return doReflow(this, action, scope)\n  }\n}\n\nfunction doReflow<T extends ActionName>(\n  interactable: Interactable,\n  action: ActionProps<T>,\n  scope: Scope,\n): Promise<Interactable> {\n  const elements = interactable.getAllElements()\n\n  // tslint:disable-next-line variable-name\n  const Promise = (scope.window as any).Promise\n  const promises: Array<Promise<null>> | null = Promise ? [] : null\n\n  for (const element of elements) {\n    const rect = interactable.getRect(element as HTMLElement | SVGElement)\n\n    if (!rect) {\n      break\n    }\n\n    const runningInteraction = arr.find(scope.interactions.list, (interaction: Interaction) => {\n      return (\n        interaction.interacting() &&\n        interaction.interactable === interactable &&\n        interaction.element === element &&\n        interaction.prepared.name === action.name\n      )\n    })\n    let reflowPromise: Promise<null>\n\n    if (runningInteraction) {\n      runningInteraction.move()\n\n      if (promises) {\n        reflowPromise =\n          runningInteraction._reflowPromise ||\n          new Promise((resolve: any) => {\n            runningInteraction._reflowResolve = resolve\n          })\n      }\n    } else {\n      const xywh = tlbrToXywh(rect)\n      const coords = {\n        page: { x: xywh.x, y: xywh.y },\n        client: { x: xywh.x, y: xywh.y },\n        timeStamp: scope.now(),\n      }\n\n      const event = pointerUtils.coordsToEvent(coords)\n      reflowPromise = startReflow<T>(scope, interactable, element, action, event)\n    }\n\n    if (promises) {\n      promises.push(reflowPromise)\n    }\n  }\n\n  return promises && Promise.all(promises).then(() => interactable)\n}\n\nfunction startReflow<T extends ActionName>(\n  scope: Scope,\n  interactable: Interactable,\n  element: Element,\n  action: ActionProps<T>,\n  event: any,\n) {\n  const interaction = scope.interactions.new({ pointerType: 'reflow' })\n  const signalArg = {\n    interaction,\n    event,\n    pointer: event,\n    eventTarget: element,\n    phase: 'reflow',\n  } as const\n\n  interaction.interactable = interactable\n  interaction.element = element\n  interaction.prevEvent = event\n  interaction.updatePointer(event, event, element, true)\n  pointerUtils.setZeroCoords(interaction.coords.delta)\n\n  copyAction(interaction.prepared, action)\n  interaction._doPhase(signalArg)\n\n  const { Promise } = scope.window as unknown as { Promise: PromiseConstructor }\n  const reflowPromise = Promise\n    ? new Promise<undefined>((resolve) => {\n        interaction._reflowResolve = resolve\n      })\n    : undefined\n\n  interaction._reflowPromise = reflowPromise\n  interaction.start(action, interactable, element)\n\n  if (interaction._interacting) {\n    interaction.move(signalArg)\n    interaction.end(event)\n  } else {\n    interaction.stop()\n    interaction._reflowResolve()\n  }\n\n  interaction.removePointer(event, event)\n\n  return reflowPromise\n}\n\nconst reflow: Plugin = {\n  id: 'reflow',\n  install,\n  listeners: {\n    // remove completed reflow interactions\n    'interactions:stop': ({ interaction }, scope) => {\n      if (interaction.pointerType === 'reflow') {\n        if (interaction._reflowResolve) {\n          interaction._reflowResolve()\n        }\n\n        arr.remove(scope.interactions.list, interaction)\n      }\n    },\n  },\n}\n\nexport default reflow\n"
	],
	"mappings": ";;;;;;AAIA,IAAAA,GAAA,GAAAC,uBAAA,CAAAC,OAAA;AACA,IAAAC,KAAA,GAAAD,OAAA;AACA,IAAAE,YAAA,GAAAH,uBAAA,CAAAC,OAAA;AACA,IAAAG,KAAA,GAAAH,OAAA;AAAmD,SAAAI,yBAAAC,CAAA,6BAAAC,OAAA,mBAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAF,wBAAA,YAAAA,CAAAC,CAAA,WAAAA,CAAA,GAAAG,CAAA,GAAAD,CAAA,KAAAF,CAAA;AAAA,SAAAN,wBAAAM,CAAA,EAAAE,CAAA,SAAAA,CAAA,IAAAF,CAAA,IAAAA,CAAA,CAAAI,UAAA,SAAAJ,CAAA,eAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA,WAAAK,OAAA,EAAAL,CAAA,QAAAG,CAAA,GAAAJ,wBAAA,CAAAG,CAAA,OAAAC,CAAA,IAAAA,CAAA,CAAAG,GAAA,CAAAN,CAAA,UAAAG,CAAA,CAAAI,GAAA,CAAAP,CAAA,OAAAQ,CAAA,KAAAC,SAAA,UAAAC,CAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,CAAA,IAAAd,CAAA,oBAAAc,CAAA,IAAAH,MAAA,CAAAI,SAAA,CAAAC,cAAA,CAAAC,IAAA,CAAAjB,CAAA,EAAAc,CAAA,SAAAI,CAAA,GAAAR,CAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAb,CAAA,EAAAc,CAAA,UAAAI,CAAA,KAAAA,CAAA,CAAAX,GAAA,IAAAW,CAAA,CAAAC,GAAA,IAAAR,MAAA,CAAAC,cAAA,CAAAJ,CAAA,EAAAM,CAAA,EAAAI,CAAA,IAAAV,CAAA,CAAAM,CAAA,IAAAd,CAAA,CAAAc,CAAA,YAAAN,CAAA,CAAAH,OAAA,GAAAL,CAAA,EAAAG,CAAA,IAAAA,CAAA,CAAAgB,GAAA,CAAAnB,CAAA,EAAAQ,CAAA,GAAAA,CAAA;AA6CnD,SAASY,OAAOA,CAACC,KAAY,EAAE;EAC7B,MAAM;IAAEC;EAAa,CAAC,GAAGD,KAAK;EAE9BA,KAAK,CAACE,OAAO,CAACC,MAAM,CAACC,MAAM,GAAG,IAAI;EAElCH,YAAY,CAACP,SAAS,CAACU,MAAM,GAAG,UAAUC,MAAmB,EAAE;IAC7D,OAAOC,QAAQ,CAAC,IAAI,EAAED,MAAM,EAAEL,KAAK,CAAC;EACtC,CAAC;AACH;AAEA,SAASM,QAAQA,CACfC,YAA0B,EAC1BF,MAAsB,EACtBL,KAAY,EACW;EACvB,MAAMQ,QAAQ,GAAGD,YAAY,CAACE,cAAc,CAAC,CAAC;;EAE9C;EACA,MAAMC,OAAO,GAAIV,KAAK,CAACW,MAAM,CAASD,OAAO;EAC7C,MAAME,QAAqC,GAAGF,OAAO,GAAG,EAAE,GAAG,IAAI;EAEjE,KAAK,MAAMG,OAAO,IAAIL,QAAQ,EAAE;IAC9B,MAAMM,IAAI,GAAGP,YAAY,CAACQ,OAAO,CAACF,OAAmC,CAAC;IAEtE,IAAI,CAACC,IAAI,EAAE;MACT;IACF;IAEA,MAAME,kBAAkB,GAAG5C,GAAG,CAAC6C,IAAI,CAACjB,KAAK,CAACkB,YAAY,CAACC,IAAI,EAAGC,WAAwB,IAAK;MACzF,OACEA,WAAW,CAACC,WAAW,CAAC,CAAC,IACzBD,WAAW,CAACb,YAAY,KAAKA,YAAY,IACzCa,WAAW,CAACP,OAAO,KAAKA,OAAO,IAC/BO,WAAW,CAACE,QAAQ,CAACC,IAAI,KAAKlB,MAAM,CAACkB,IAAI;IAE7C,CAAC,CAAC;IACF,IAAIC,aAA4B;IAEhC,IAAIR,kBAAkB,EAAE;MACtBA,kBAAkB,CAACS,IAAI,CAAC,CAAC;MAEzB,IAAIb,QAAQ,EAAE;QACZY,aAAa,GACXR,kBAAkB,CAACU,cAAc,IACjC,IAAIhB,OAAO,CAAEiB,OAAY,IAAK;UAC5BX,kBAAkB,CAACY,cAAc,GAAGD,OAAO;QAC7C,CAAC,CAAC;MACN;IACF,CAAC,MAAM;MACL,MAAME,IAAI,GAAG,IAAAC,gBAAU,EAAChB,IAAI,CAAC;MAC7B,MAAMiB,MAAM,GAAG;QACbC,IAAI,EAAE;UAAEC,CAAC,EAAEJ,IAAI,CAACI,CAAC;UAAEC,CAAC,EAAEL,IAAI,CAACK;QAAE,CAAC;QAC9BC,MAAM,EAAE;UAAEF,CAAC,EAAEJ,IAAI,CAACI,CAAC;UAAEC,CAAC,EAAEL,IAAI,CAACK;QAAE,CAAC;QAChCE,SAAS,EAAEpC,KAAK,CAACqC,GAAG,CAAC;MACvB,CAAC;MAED,MAAMC,KAAK,GAAG9D,YAAY,CAAC+D,aAAa,CAACR,MAAM,CAAC;MAChDP,aAAa,GAAGgB,WAAW,CAAIxC,KAAK,EAAEO,YAAY,EAAEM,OAAO,EAAER,MAAM,EAAEiC,KAAK,CAAC;IAC7E;IAEA,IAAI1B,QAAQ,EAAE;MACZA,QAAQ,CAAC6B,IAAI,CAACjB,aAAa,CAAC;IAC9B;EACF;EAEA,OAAOZ,QAAQ,IAAIF,OAAO,CAACgC,GAAG,CAAC9B,QAAQ,CAAC,CAAC+B,IAAI,CAAC,MAAMpC,YAAY,CAAC;AACnE;AAEA,SAASiC,WAAWA,CAClBxC,KAAY,EACZO,YAA0B,EAC1BM,OAAgB,EAChBR,MAAsB,EACtBiC,KAAU,EACV;EACA,MAAMlB,WAAW,GAAGpB,KAAK,CAACkB,YAAY,CAAC0B,GAAG,CAAC;IAAEC,WAAW,EAAE;EAAS,CAAC,CAAC;EACrE,MAAMC,SAAS,GAAG;IAChB1B,WAAW;IACXkB,KAAK;IACLS,OAAO,EAAET,KAAK;IACdU,WAAW,EAAEnC,OAAO;IACpBoC,KAAK,EAAE;EACT,CAAU;EAEV7B,WAAW,CAACb,YAAY,GAAGA,YAAY;EACvCa,WAAW,CAACP,OAAO,GAAGA,OAAO;EAC7BO,WAAW,CAAC8B,SAAS,GAAGZ,KAAK;EAC7BlB,WAAW,CAAC+B,aAAa,CAACb,KAAK,EAAEA,KAAK,EAAEzB,OAAO,EAAE,IAAI,CAAC;EACtDrC,YAAY,CAAC4E,aAAa,CAAChC,WAAW,CAACW,MAAM,CAACsB,KAAK,CAAC;EAEpD,IAAAC,gBAAU,EAAClC,WAAW,CAACE,QAAQ,EAAEjB,MAAM,CAAC;EACxCe,WAAW,CAACmC,QAAQ,CAACT,SAAS,CAAC;EAE/B,MAAM;IAAEpC;EAAQ,CAAC,GAAGV,KAAK,CAACW,MAAoD;EAC9E,MAAMa,aAAa,GAAGd,OAAO,GACzB,IAAIA,OAAO,CAAaiB,OAAO,IAAK;IAClCP,WAAW,CAACQ,cAAc,GAAGD,OAAO;EACtC,CAAC,CAAC,GACF6B,SAAS;EAEbpC,WAAW,CAACM,cAAc,GAAGF,aAAa;EAC1CJ,WAAW,CAACqC,KAAK,CAACpD,MAAM,EAAEE,YAAY,EAAEM,OAAO,CAAC;EAEhD,IAAIO,WAAW,CAACsC,YAAY,EAAE;IAC5BtC,WAAW,CAACK,IAAI,CAACqB,SAAS,CAAC;IAC3B1B,WAAW,CAACuC,GAAG,CAACrB,KAAK,CAAC;EACxB,CAAC,MAAM;IACLlB,WAAW,CAACwC,IAAI,CAAC,CAAC;IAClBxC,WAAW,CAACQ,cAAc,CAAC,CAAC;EAC9B;EAEAR,WAAW,CAACyC,aAAa,CAACvB,KAAK,EAAEA,KAAK,CAAC;EAEvC,OAAOd,aAAa;AACtB;AAEA,MAAMpB,MAAc,GAAG;EACrB0D,EAAE,EAAE,QAAQ;EACZ/D,OAAO;EACPgE,SAAS,EAAE;IACT;IACA,mBAAmB,EAAEC,CAAC;MAAE5C;IAAY,CAAC,EAAEpB,KAAK,KAAK;MAC/C,IAAIoB,WAAW,CAACyB,WAAW,KAAK,QAAQ,EAAE;QACxC,IAAIzB,WAAW,CAACQ,cAAc,EAAE;UAC9BR,WAAW,CAACQ,cAAc,CAAC,CAAC;QAC9B;QAEAxD,GAAG,CAAC6F,MAAM,CAACjE,KAAK,CAACkB,YAAY,CAACC,IAAI,EAAEC,WAAW,CAAC;MAClD;IACF;EACF;AACF,CAAC;AAAA,IAAA8C,QAAA,GAAAC,OAAA,CAAAnF,OAAA,GAEcoB,MAAM"
}