Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=i(require("../utils/arr.prod.js")),t=require("../utils/misc.prod.js"),r=i(require("../utils/pointerUtils.prod.js")),o=require("../utils/rect.prod.js");function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=e=>e?r:t)(e)}function i(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var o={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var l=i?Object.getOwnPropertyDescriptor(e,s):null;l&&(l.get||l.set)?Object.defineProperty(o,s,l):o[s]=e[s]}return o.default=e,r&&r.set(e,o),o}function s(e,o,n,i,s){const l=e.interactions.new({pointerType:"reflow"}),a={interaction:l,event:s,pointer:s,eventTarget:n,phase:"reflow"};l.interactable=o,l.element=n,l.prevEvent=s,l.updatePointer(s,s,n,!0),r.setZeroCoords(l.coords.delta),(0,t.copyAction)(l.prepared,i),l._doPhase(a);const{Promise:p}=e.window,c=p?new p((e=>{l._reflowResolve=e})):void 0;return l._reflowPromise=c,l.start(i,o,n),l._interacting?(l.move(a),l.end(s)):(l.stop(),l._reflowResolve()),l.removePointer(s,s),c}const l={id:"reflow",install(t){const{Interactable:n}=t;t.actions.phases.reflow=!0,n.prototype.reflow=function(n){return((t,n,i)=>{const l=t.getAllElements(),a=i.window.Promise,p=a?[]:null;for(const c of l){const l=t.getRect(c);if(!l)break;const f=e.find(i.interactions.list,(e=>e.interacting()&&e.interactable===t&&e.element===c&&e.prepared.name===n.name));let u;if(f)f.move(),p&&(u=f._reflowPromise||new a((e=>{f._reflowResolve=e})));else{const e=(0,o.tlbrToXywh)(l),a={page:{x:e.x,y:e.y},client:{x:e.x,y:e.y},timeStamp:i.now()},p=r.coordsToEvent(a);u=s(i,t,c,n,p)}p&&p.push(u)}return p&&a.all(p).then((()=>t))})(this,n,t)}},listeners:{"interactions:stop"({interaction:t},r){"reflow"===t.pointerType&&(t._reflowResolve&&t._reflowResolve(),e.remove(r.interactions.list,t))}}};exports.default=l;
//# sourceMappingURL=plugin.prod.js.map